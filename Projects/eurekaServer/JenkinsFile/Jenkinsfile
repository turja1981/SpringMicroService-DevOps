	node  {

	mvnHome = tool 'mvn_3.5.4'


	echo "PATH = ${PATH}"
	echo "M3_HOME = ${mvnHome}"
	env.PATH = "${mvnHome}/bin:${PATH}"


	stage('Checkout SCM') { checkout scm }

	stage('Build') {

		dir ('Projects/eurekaServer') { sh "mvn clean install -Dmaven.test.skip=true " }
	}


	stage('Create Docker Image') {
		sh "cp Projects/eurekaServer/target/*.jar Projects/eurekaServer/dockerfile/"
		dir ('Projects/eurekaServer/dockerfile') {
			def dicoveryApp = docker.build("int_region/discovery-service:${env.BUILD_ID}")
		}
	}
	stage ('Run Docker Image') {
		docker.image("int_region/discovery-service:${env.BUILD_ID}").run('-p 8761:8761 -h discovery --name discovery --network  docknet --ip=172.18.0.4')
	}
}

