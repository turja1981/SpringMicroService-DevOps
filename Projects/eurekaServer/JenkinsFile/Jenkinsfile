	node  {

	mvnHome = tool 'maven_3.3.9'


    echo "PATH = ${PATH}"
    echo "M3_HOME = ${mvnHome}"
    env.PATH = "${mvnHome}/bin:${PATH}"
                   
       
	stage('Checkout SCM') {checkout scm }

	stage('Build') {

		dir ('Projects/eurekaServer') { sh "mvn clean install -Dmaven.test.skip=true " }
	}
}

stage('Image') {


		sh "cp Projects/eurekaServer/target/*.jar Projects/eurekaServer/dockerfile/"


		dir ('Projects/eurekaServer/dockerfile') {
			def dicoveryApp = docker.build("int-region/discovery-service:${env.BUILD_ID}")
		}
	
}
stage ('Eureka Run') {

	script {
		docker.image("int-region/discovery-service:${env.BUILD_ID}").run('-p 8761:8761 -h discovery --name discovery --network  devops_default --dns=172.18.0.4')
	}
}


